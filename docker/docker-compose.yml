services:
  Frontend:
    image: nginx:latest
    container_name: frontend
    ports:
      - "30000:80"
    volumes:
      - type: bind
        source: ./frontend/conf.d
        target: /etc/nginx/conf.d
        read_only: true
      - type: bind
        source: ./frontend/html
        target: /usr/share/nginx/html
        read_only: true
    networks:
      - default
    restart: unless-stopped
  Backend:
    image: knightfemale/djagon-backend:latest
    container_name: djagon-backend
    ports:
      - "30001:30001"
    environment:
      BACKEND_IN_DOCKER: "True"
      SECRET_KEY: "${SECRET_KEY}"
      BACKEND_DEBUG: "${BACKEND_DEBUG}"
      FRONTEND_DOMAIN: "${FRONTEND_DOMAIN}"
    networks:
      - default
    command: uv run ./main.py
    restart: unless-stopped
  Database:
    image: postgres:17
    container_name: database
    ports:
      - "30002:5432"
    environment:
      POSTGRES_USER: admin
      POSTGRES_PASSWORD: passwd
    volumes:
      - type: bind
        source: ./database/data
        target: /var/lib/postgresql/data
    networks:
      - default

networks:
  default:
    driver: bridge
